nextflow.enable.dsl = 2

// Real-time monitoring and logging
timeline {
    enabled = true
    file = 'timeline.html'
}

trace {
    enabled = true
    file = 'trace.txt'
}

report {
    enabled = true
    file = 'report.html'
}

dag {
    enabled = true
    file = 'dag.html'
}

// Real-time progress updates
log {
    level = 'info'
    file = 'nextflow.log'
    append = false
}

// Enable real-time process monitoring
monitor {
    enabled = true
    interval = '30s'
}

// Enable process output streaming
process {
    publishDir = [:]
    publishDir.mode = 'copy'
    publishDir.overwrite = true
}

process {
    executor = 'slurm'               // Use SLURM cluster scheduler
    queue = 'galaxy'                 // Your SLURM queue or partition
    cpus =  1                        // CPUs per task
    memory = '15GB'                  // Memory per task
    time = '600h'                      // Max run time
    maxForks = 22    // max concurrent jobs
    queueSize = 50   // optional, buffers more jobs
    

    container = '/gladstone/finkbeiner/steve/work/projects/nextflow-cluster/nextflow-cluster.sif'
   // containerEngine = 'apptainer'
    containerOptions = "--bind $HOME/nextflow-cluster/bin:/app \
                        --bind /gladstone/finkbeiner:/gladstone/finkbeiner:rw \
                        --nv"
   
    shell = ['/bin/bash']
}

